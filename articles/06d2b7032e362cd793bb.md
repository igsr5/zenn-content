---
title: "ã€Railsã€‘Active Recordã§ã©ã‚“ãªã‚¯ã‚¨ãƒªãŒç™ºè¡Œã•ã‚Œã¦ã„ã‚‹ã®ã‹è¦‹ã¦ã¿ã‚‹ã€‚"
emoji: "ğŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ['rails','ruby','active record','sql','postgresql']
published: true
---
è‡ªåˆ†ç”¨ãƒãƒ¼ãƒˆã€‚ï¼ˆã“ã®è¨˜äº‹ã®å†…å®¹ã‚’ã¿ã¦å‹‰å¼·ã—ãªã„æ–¹ãŒã„ã„ã§ã™ï¼‰
ãƒ¡ãƒ¢ãƒªãŸã„ã‚‚ã®ãŒå¢—ãˆãŸã‚‰æ›´æ–°ã™ã‚‹ã€‚
## all
```ruby:Rails
User.all
```
```sql:SQL
SELECT "users".* FROM "users"
```
## select
```ruby:Rails
User.select(:name)
```
```sql:SQL
SELECT "name" FROM "users" LIMIT $1  [["LIMIT", 11]]
```
## find
```ruby:Rails
User.find(1)
```
```sql:SQL
SELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2  [["id", 1], ["LIMIT", 1]]
```
## find_by
```ruby:Rails
User.find_by(email: 'hoge@hoge')
```
```sql:SQL
SELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2  [["email", "hoge@hoge"], ["LIMIT", 1]]
```
## where
```ruby:Rails
User.where(email: 'hoge@hoge')
```
```sql:SQL
SELECT "users".* FROM "users" WHERE "users"."email" = $1  [["email", "hoge@hoge"]]
```
## create
```ruby:Rails
User.create(email: 'fuga@fuga', password: 'fuga', password_confirmation: 'fuga', family_name: 'fuga', given_name: 'fuga')
```
â€»User.emailã«ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯ç¸›ã‚Šã‚ã‚Šã€‚
```sql:SQL
SELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2  [["email", "fuga@fuga"], ["LIMIT", 1]]
INSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "family_name", "given_name") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["email", "fuga@fuga"], ["password_digest", "â—‹â—‹"], ["created_at", "2021-01-17 06:08:37.410580"], ["updated_at", "2021-01-17 06:08:37.410580"], ["family_name", "fuga"], ["given_name", "fuga"]]
```
# group
```ruby:Rails
Address.group(:user_id)
```
```sql:SQL
SELECT "addresses".* FROM "addresses" GROUP BY "addresses"."postal_code"
```
# having
```ruby:Rails
Address.group(:user_id).having('count(*) > ?', 2).count
```
```sql:SQL
SELECT "addresses".* FROM "addresses" GROUP BY "addresses"."user_id" HAVING (count(*) > 2)
```
# é–¢é€£ä»˜ã‘(association)
```ruby:Rails
User.find(1).addresses
```
```sql:SQL
SELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2  [["id", 1], ["LIMIT", 1]]
SELECT "addresses".* FROM "addresses" WHERE "addresses"."user_id" = $1  [["user_id", 1]]
```
```ruby:Rails
Address.find(1).user
```
```sql:SQL
SELECT "addresses".* FROM "addresses" WHERE "addresses"."id" = $1 LIMIT $2  [["id", 1], ["LIMIT", 1]]
SELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2  [["id", 1], ["LIMIT", 1]]
```
```ruby:Rails
User.includes('addresses').all
```
```sql:SQL
SELECT "users".* FROM "users"
SELECT "addresses".* FROM "addresses" WHERE "addresses"."user_id" = $1  [["user_id", 1]]
```
# join(å†…éƒ¨çµåˆ)
```ruby:Rails
User.joins(:addresses)
```
```sql:SQL
SELECT "users".* FROM "users" INNER JOIN "addresses" ON "addresses"."user_id" = "users"."id"
```
# left_joins(å·¦å¤–éƒ¨çµåˆ)
```ruby:Rails
User.left_joins(:addresses)
```
```sql:SQL
SELECT "users".* FROM "users" LEFT OUTER JOIN "addresses" ON "addresses"."user_id" = "users"."id"
```
